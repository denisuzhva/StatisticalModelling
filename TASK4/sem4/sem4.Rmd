---
author: "Денис Ужва"
title: "Практика 4 (дисперсионный анализ, непараметрические критерии однородности)"
output: html_document
---




# Дисперсионный анализ


## Задача 4.1-1

Загрузим данные:

```{r t1Data}
di1 <- c(3, 6, 7, 4)
di2 <- c(10, 12, 11, 14, 8, 6)
di3 <- c(8, 3, 2, 5)
confProb <- 1-0.05
```

С помощью F-критерия проверим, есть ли разница в диетах. 
Для начала посчитаем значения df для числителя и знаменателя.

```{r t1df}
n <- c(length(di1), length(di2), length(di3))
nBig <- sum(n)
k = 3
dfk <- k - 1
dfn <- nBig - k
dfk
dfn
fCrit <- qf(confProb, df1=dfk, df2=dfn)
fCrit
```

Таким образом, критическое значение F-критерия равно 3.98.
Теперь посчитаем сам критерий.

```{r t1F}
xL <- c(mean(di1), mean(di2), mean(di3))
xLL <- mean(xL)
ssB <- sum(n * (xL - xLL)^2)
ssW <- sum((di1 - xL[1])^2) + sum((di2 - xL[2])^2) + sum((di3 - xL[3])^3)
msB <- ssB / dfk
msW <- ssW / dfn
fEst <- msB / msW
fEst
```

Полученное значение 7.70 больше критического 3.98 (на уровне значимости $\alpha = 0.05$), поэтому гипотеза о равенстве средних трёх выборок отвергается и принимается альтернативная.
  

## Задача 4.1-4

Загрузим данные:

```{r t2Data}
a1 <- c(62, 64, 66)
a2 <- c(65, 68, 72)
b1 <- c(58, 62, 53)
b2 <- c(83, 85, 91)
ssA <- 816.750
ssB <- 102.083
ssAB <- 444.083
ssErr <- 108
confProb <- 1-0.05
```

Рассчитаем df

```{r t2df}
A <- 2
B <- 2
dfA <- A - 1
dfB <- B - 1
nGroup <- 3
dfAB <- dfA * dfB
dfD <- A * B * (nGroup - 1)
dfA
dfB
dfAB
dfD
fCritA <- qf(confProb, dfA, dfD)
fCritB <- qf(confProb, dfB, dfD)
fCritAB <- qf(confProb, dfAB, dfD)
fCritA
fCritB
fCritAB
```

Таким образом, критические значения FA, FB и FAB равны 5.32.
Поскольку значения $SS_A$, $SS_B$, $SS_{A \times B}$ и $SS_\textrm{within}$ известны, можно посчитать значения критериев.

```{r t2F}
msA <- ssA / dfA
msB <- ssB / dfB
msAB <- ssAB / dfAB
msErr <- ssErr / dfD
fA <- msA / msErr
fB <- msB / msErr
fAB <- msAB / msErr
fA
fB
fAB
```

Видно, что все три значения критерия превосходят критический порог.
Так как $F_{A \times B}$ больше критического значения, то нулевая гипотеза, утверждающая, что тип диеты и тип упражнения не влияют на уровень глюкозы, отвергается. 
Следовательно, между этими двумя факторами существует взаимодействие, и они влияют на уровень глюкозы (на уровне значимости $\alpha = 0.05$).


## Задача 4.2-2

Загрузим данные:

```{r t3Data}
samp <- c(420, 460, 514, 405, 320, 435, 531, 450, 560, 309, 312, 350)
meanProp <- 325
confProb <- 1 - 0.05
```

Проверяем гипотезу о среднем:

```{r t3Score}
meanArr <- rep(meanProp, length(samp))
wilcox.test(samp, meanArr, paired=TRUE)
```

Поскольку полученное p-value меньше уровня значимости $\alpha = 0.05$, можно сделать вывод, что на этом уровне значимости нулевая гипотеза отвергается, то бишь заявление агента о среднем опровергнуто.


## Задача 4.2-7

Загрузим данные:

```{r t4Data}
samp1 <- c(2.19, 2.26, 2.28, 2.21, 1.87, 2.34, 2.14, 1.93, 2.10, 1.89, 2.36, 2.17)
samp2 <- c(1.98, 2.31, 2.25, 1.91, 2.15, 2.12, 1.83, 2.13, 2.11, 2.16, 1.99)
```

Найдём критерий Манна-Уитни:

```{r t4MW}
wilcox.test(samp1, samp2)
```

Значение $W = 84$ больше критического (равного 30 для $k_1 = 11$, $k_2 = 12$).
Таким образом, выборки являются однородными.