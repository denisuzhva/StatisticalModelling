---
author: "Денис Ужва"
title: "Практика 5 (корреляция, регрессия, ранговая регрессия)"
output: html_document
---




# Корреляция и регрессия


## Задача 5.1-1

Загрузим данные:

```{r t1Data}
s1 <- c(18, 24, 36, 40, 58)
s2 <- c(3.9, 2.6, 2, 2.3, 1.2)
n <- length(s1)
```

Построим график, на котором отложены соответствующие точки в двумерном пространстве.

```{r t1Plot}
plot(s1, s2, xlab='age', ylab='hours')
```

Видно, что существует некоторая отрицательная корреляция, сигнализирующая о наличии обратной зависимости выборок.
Вычислим коэффициент корреляции Пирсона для численной проверки корреляции:

```{r t1Pearson}
s1mean <- mean(s1)
s2mean <- mean(s2)
r <- sum((s1 - s1mean) * (s2 - s2mean)) / sqrt(sum((s1 - s1mean)^2) * sum((s2 - s2mean)^2))
r

t <- r * sqrt((n-2) / (1 - r^2))
confLevel <- 0.05
tCrit <- qt(confLevel, n-2)
t
tCrit
```

Полученный коэффициент корреляции близок к -1, что говорит об очень высокой отрицательной корреляции выборок.
Исходя из значения t-критерия на уровне значимости $\alpha = 0.05$, гипотеза о нулевом коэффициенте корреляции отвергается, так как это значение лежит в критической области.


## Задача 5.1-7

Загрузим данные:

```{r t2Data}
s1 <- c(10, 12, 2, 0, 8, 5)
s2 <- c(70, 65, 96, 94, 75, 82)
```

Построим график, на котором отложены соответствующие точки в двумерном пространстве.

```{r t2Plot}
plot(s1, s2, xlab='passes', ylab='final score')
```

Видно, что существует некоторая отрицательная корреляция, сигнализирующая о наличии обратной зависимости выборок.
Вычислим коэффициент корреляции Пирсона для численной проверки корреляции:

```{r t2Pearson}
s1mean <- mean(s1)
s2mean <- mean(s2)
r <- sum((s1 - s1mean) * (s2 - s2mean)) / sqrt(sum((s1 - s1mean)^2) * sum((s2 - s2mean)^2))
r

t <- r * sqrt((n-2) / (1 - r^2))
confLevel <- 0.05
tCrit <- qt(confLevel, n-2)
t
tCrit
```

Нулевая гипотеза: коэффициент корреляции генеральной совокупности равен нулю ($\varrho = 0$), альтернативная гипотеза: $\varrho \neq 0$.
Исходя из значения t-критерия, нулевая гипотеза отвергается, поскольку он лежит в критической области.

Найдём уравнение регрессии и построим соответствующую прямую на графике рассеивания:
```{r t2Regr}
LM <- lm(s2~s1)
SLM <- summary(LM)
ab. <- SLM$coefficients[,1]
ab.
plot(s1, s2, xlab='passes', ylab='final score')
abline(LM)
```

Видно, что линия регрессии хорошо ложится на график рассеивания, и с её помощью можно предсказывать оценки по данному количеству пропусков.



# Ранговая корреляция


## Задача 5.2-1

Загрузим данные:

```{r t3Data}
s1 <- c(4, 6, 2, 8, 1, 7, 3, 5)
s2 <- c(1, 7, 5, 4, 3, 8, 2, 6)
```

Вычислим коэффициент Спирмена:

```{r t3Spear}
cor.test(s1, s2, method='spearman')
```

Таким образом, коэффициент $\pho$ на уровне значимости $\alpha = 0.05$ не лежит в критической области, то бишь основная гипотеза принимается.


## Задача 5.2-4

Загрузим данные:

```{r t4Data}
s1 <- c(107, 95, 116, 109, 101, 98)
s2 <- c(107, 102, 112, 104, 105, 103)
```

Посчитаем коэффициент Кендалла:

```{r t4Kend}
cor.test(s1, s2, method='kendall')
```

Видно, что коэффициент $\tau$ не заходит в границу критической области для уровня значимости $\alpha = 0.05$, то есть основная гипотеза принимаетя.

